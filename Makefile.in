all:

build:
	@echo nothing to do

.PHONY : install
install:
	@mkdir -p ${DESTDIR}${PREFIX}/bin/ || :
	@mkdir -p ${DESTDIR}${PREFIX}/share/doc/git-devbliss/ || :
	@mkdir -p ${DESTDIR}${PREFIX}/share/man/man1 || :
	@mkdir -p ${DESTDIR}${PREFIX}/etc/bash_completion.d/ || :
	@cp git-devbliss ${DESTDIR}${PREFIX}/bin/
	@cp github.py ${DESTDIR}${PREFIX}/bin/github-devbliss
	@mkdir -p ${DESTDIR}${PREFIX}/share/doc/git-devbliss/
	@cp CHANGES.md ${DESTDIR}${PREFIX}/share/doc/git-devbliss/
	@chmod a+x ${DESTDIR}${PREFIX}/bin/github-devbliss
	@git config --global alias.de devbliss
	@cp bash_completion/git-devbliss ${DESTDIR}${PREFIX}/etc/bash_completion.d/
	@cp man1/* ${DESTDIR}${PREFIX}/share/man/man1/
	@echo To enable bash completion, source '${DESTDIR}${PREFIX}/etc/bash_completion.d/git-devbliss':
	@echo
	@echo "    echo \"source ${DESTDIR}${PREFIX}/etc/bash_completion.d/git-devbliss\" >> ~/.profile"
	@echo
	@echo done

.PHONY : uninstall
uninstall:
	@rm -f ${DESTDIR}${PREFIX}/bin/git-devbliss
	@rm -f ${DESTDIR}${PREFIX}/etc/bash_completion.d/git-devbliss
	@rm -f ${DESTDIR}${PREFIX}/bin/github-devbliss
	@rm -rf ${DESTDIR}${PREFIX}/share/doc/git-devbliss/
	@rm -f ${DESTDIR}${PREFIX}/share/man/man1/git-devbliss.1

define changelog_cmd
	changelog="CHANGES.md"
	if [ -z "$$EDITOR" ]; then
		EDITOR=vi
	fi
	$$EDITOR $$changelog
endef
export changelog_cmd
.PHONY : changelog
changelog:
	@bash -c "$$changelog_cmd"

.PHONY : version
version:
	@bash -c "$$changelog_cmd"

.PHONY : test

test:
	$(MAKE) --no-print-directory silent_test

silent_test:
	fail --all
